<html lang="en">
    <head>
	<title>Experiment server UI</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="https://kit.fontawesome.com/1e694dd391.js" crossorigin="anonymous"></script>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
	<script src="https://unpkg.com/htmx.org@1.9.10"></script>
	<script src="https://unpkg.com/htmx.org/dist/ext/response-targets.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
	<script>
	 document.addEventListener("htmx:confirm", function (e) {
	     e.preventDefault();
	     if (!e.target.hasAttribute('hx-confirm')) {
		 e.detail.issueRequest(true);
		 return;
	     }
	     swalConfirm(e.detail.question, () => {})
	     Swal.fire({
		 text: e.detail.question,
		 showDenyButton: true
	     }).then(function (result) {
		 if (result.isConfirmed)
                     e.detail.issueRequest(true);
	     })
	 });
	</script>
	<style>
	 .indicator {
	     visibility: visible;
	 }

	 .htmx-request .indicator {
	     visibility: hidden;
	 }

	 .htmx-request.indicator {
	     visibility: hidden;
	 }
	</style>
    </head>
    <body>
        <div class="container" x-data="{ useDefaultPP: true }"
            x-init="$watch('useDefaultPP', () => htmx.process($el))">
            <div class="col-sm-12 mt-4 align-middle">
		<button class="btn btn-primary mx-4"><i class="fa-solid fa-arrows-rotate fa-2xs"></i></button>
                <div class="font-weight-bold mt-2" hx-get="/web/status-string"
                    hx-trigger="load delay:0.1s, click from:button, change from:.status-monitor, every 10s"
                    hx-swap="none"
                    hx-include="#checkUseDefault,#txtPPID"
                    hx-indicator="indicator">
                </div>
                <div id="status" class="alert alert-light"> </div>
                <div id="output" class="indicator"> </div>
            </div>
	    <div class="row">
		<div class="col-sm-12">
                    <div class="form-check form-switch align-middle" style="width:100%;">
                        <input class="form-check-input status-monitor" type="checkbox" role="switch" id="checkUseDefault" name="checkUseDefult"
                            x-model="useDefaultPP"/>
                        <input type="hidden" name="checkUseDefault" value="off" />
                        <label class="form-check-label" for="checkUseDefault">Monitor default participant</label>
                    </div>
                </div>
            </div>
	    <div class="row">
		<div class="col-sm-6 mt-2">
		    <label style="width:100%"
                        for="txtPPID"
			x-bind:disabled="useDefaultPP">
			    Change participant monitored to:
		    </label>
		</div>
		<div class="col-sm-4 mt-2">
		    <input type="text" id="txtPPID" name="txtPPID" class="form-control"
			x-bind:disabled="useDefaultPP"/>
		</div>
		<div class="col-sm-2 mt-2">
		    <button type="button" class="btn btn-primary"
			x-bind:disabled="useDefaultPP">
                        Set
                    </button>
		</div>
	    </div>
	    <div class="row">
		<div class="col-sm-6 mt-2">
		    <label style="width:100%"
                        for="txtBlockID">
                        Move to block:
		    </label>
		</div>
		<div class="col-sm-4 mt-2">
		    <input type="text" id="txtBlockID" name="txtBlockID" class="form-control"/>
		</div>
		<div class="col-sm-2 mt-2">
                    <button type="button" class="btn btn-primary"
                        hx-get="/web/move-to-block"
                        hx-trigger="click"
                        hx-include="#checkUseDefault,#txtPPID,#txtBlockID"
                        hx-swap="none">
                        Set
                    </button>
		</div>
	    </div>
	    <div class="row">
		<div class="col-sm-12 mt-2">
		    <button id="btnConfig" type="button" style="width:100%" class="btn btn-primary"
                        hx-get="/web/move-to-next"
			hx-trigger="click"
                        hx-include="#checkUseDefault,#txtPPID"
			hx-swap="none">
                        Move to next block
		    </button>
		</div>
	    </div>
	    <div class="row">
		<div class="col-sm-12 mt-2">
		    <button id="btnConfig" type="button" style="width:100%" class="btn btn-primary"
                        hx-get="/web/config"
			hx-trigger="click"
                        hx-include="#checkUseDefault,#txtPPID"
			hx-swap="none">
			View config
		    </button>
		</div>
	    </div>
        </div>
    </body>
</html>
